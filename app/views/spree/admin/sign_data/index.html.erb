<h1>Saved Signs</h1>
<label>Material Type</label>
<select id="material_type">
  <option>Please Select</option>
  <% get_material_types.each do |m| %>
     <option value="<%= m.id %>"><%= m.name%></option>
  <% end %>
</select>
<div id="select_product_list">
  <label>Material</label>
<select id="material" name="material">
<option>Please Select</option>
<% get_product_list.each do |p| %>
  <option value="<%= p.id %>"><%= p.name %></option>
<% end %>
</select>
</div>
<div id="sign_results">
    <% @signs.each do |s| %>
      <% unless s.deleted_by_admin? %>
      <div>
        <a href="/admin/sign_data/<%= s.id %>"><%= s.name %></a> <%= s.description %> <%= get_spree_product(s.spree_product_id).name %> <%= s.deleted_by_user = true ? "(Deleted by User)" : "" %><br>
        <a href="/admin/sign_data/<%= s.id %>">Details</a> | Copy and Edit | <a href="javascript:delete_sign(<%= s.id %>)">Delete</a>
      </div>
      <% end %>
    <% end %>
</div>


<script language="javascript" type="text/javascript">
  $(document).ready(function(){
      $("#material_type").change(function(){
          var material_type_id = $("#material_type").val();
          $.ajax({
            url: "/admin/sign_data/filter_product_list_ajax",
            data: { material_type_id: material_type_id }
          }).done(function(result){
            $("#select_product_list").html(result.list);
            $("#sign_results").html(result.results);
          });
      });

      $("#material").live('change', function(){
          var material_id = $("#material").val();
          $.ajax({
            url: "/admin/sign_data/filter_results_ajax",
            data: { material: material_id }
          }).done(function(result){
                //$("#select_product_list").html(result.list);
                $("#sign_results").html(result.results);
          });
      });
  });

  function delete_sign(id){
      var confirmed = confirm('Are you sure you want to delete this sign?');
      if (confirmed == true){
          $.ajax({
              url: "/admin/sign_data/delete_sign",
              data: { id: id }
          }).done(function(result){
              //do nothing
          });
          var material_id = $("#material").val();
          $.ajax({
              url: "/admin/sign_data/filter_results_ajax",
              data: { material: material_id }
          }).done(function(result){
              $("#sign_results").html(result.results);
          });
      }
  }
</script>